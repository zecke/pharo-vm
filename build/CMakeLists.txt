# This is automatically generated file using PharoFreeBSDConfig on 14 September 2014 2:36:39.70272 pm
cmake_minimum_required(VERSION 2.6.2)
project("pharo")
include(directories.cmake)
set(externalModulesDir "${outputDir}")
message("${CMAKE_MODULE_PATH}")
set(CMAKE_CONFIGURATION_TYPES Release)
include_directories(${targetPlatform}/plugins/B3DAcceleratorPlugin)
include_directories(${crossDir}/vm ${srcVMDir} ${targetPlatform}/vm ${buildDir})
add_definitions(-DNO_VM_PROFILE=1 -fno-caller-saves -DCOGMTVM=0 -DIMAGE_ENV_NAME="PHARO_IMAGE" -DIMAGE_DIALECT_NAME="pharo" -DITIMER_HEARTBEAT=1 -DDEBUGVM=0 -DLSB_FIRST=1 -O2 -DUSE_GLOBAL_STRUCT=0 -m32 -DDEFAULT_IMAGE_NAME="pharo.image" -DNDEBUG -DENABLE_FAST_BLT -g0 -D_GNU_SOURCE -msse2 -fno-tree-pre)
add_custom_command(OUTPUT version.c
		COMMAND ${platformsDir}/unix/config/verstamp version.c gcc
		COMMENT "Generating version.c"
	)
set(coreSources  ${srcVMDir}/cogit.c ${srcVMDir}/gcc3x-cointerp.c)
set(platformVMSources  ${targetPlatform}/vm/aio.c ${targetPlatform}/vm/debug.c ${targetPlatform}/vm/osExports.c ${targetPlatform}/vm/sqUnixCharConv.c ${targetPlatform}/vm/sqUnixExternalPrims.c ${targetPlatform}/vm/sqUnixHeartbeat.c ${targetPlatform}/vm/sqUnixMain.c ${targetPlatform}/vm/sqUnixMemory.c ${targetPlatform}/vm/sqUnixThreads.c ${targetPlatform}/vm/sqUnixVMProfile.c)
set(crossVMSources  ${crossDir}/vm/sqHeapMap.c ${crossDir}/vm/sqTicker.c ${crossDir}/vm/sqExternalSemaphores.c ${crossDir}/vm/sqNamedPrims.c ${crossDir}/vm/sqVirtualMachine.c)
set(extraSources version.c)
add_executable(pharo  ${coreSources} ${crossVMSources} ${platformVMSources} ${extraSources})
add_subdirectory("thirdParty/libssh2")
set(libssh2_LIB "${externalModulesDir}/libssh2.so.1")
add_library("${libssh2_LIB}" SHARED IMPORTED GLOBAL)
	set_target_properties("${libssh2_LIB}" PROPERTIES IMPORTED_LOCATION "${libssh2_LIB}")
add_dependencies("${libssh2_LIB}" "libssh2")

add_dependencies(pharo libssh2)
add_subdirectory("thirdParty/libgit2")
set(libgit2_LIB "${externalModulesDir}/libgit2.so.0.20.0")
add_library("${libgit2_LIB}" SHARED IMPORTED GLOBAL)
	set_target_properties("${libgit2_LIB}" PROPERTIES IMPORTED_LOCATION "${libgit2_LIB}")
add_dependencies("${libgit2_LIB}" "libgit2")

add_dependencies(pharo libgit2)
add_subdirectory("ADPCMCodecPlugin")
add_subdirectory("AsynchFilePlugin")
add_subdirectory("B2DPlugin")
add_subdirectory("BitBltPlugin")
add_subdirectory("BMPReadWriterPlugin")
add_subdirectory("CroquetPlugin")
add_subdirectory("ZipPlugin")
add_subdirectory("DropPlugin")
add_subdirectory("DSAPrims")
add_subdirectory("FFTPlugin")
add_subdirectory("FileCopyPlugin")
add_subdirectory("FilePlugin")
add_subdirectory("FloatArrayPlugin")
add_subdirectory("FloatMathPlugin")
add_subdirectory("IA32ABI")
add_subdirectory("JoystickTabletPlugin")
add_subdirectory("Klatt")
add_subdirectory("LargeIntegers")
add_subdirectory("Matrix2x3Plugin")
add_subdirectory("MIDIPlugin")
add_subdirectory("MiscPrimitivePlugin")
add_subdirectory("Mpeg3Plugin")
add_subdirectory("SecurityPlugin")
add_subdirectory("SerialPlugin")
add_subdirectory("SocketPlugin")
add_subdirectory("SoundCodecPrims")
add_subdirectory("SoundPlugin")
add_subdirectory("StarSqueakPlugin")
add_subdirectory("SurfacePlugin")
add_subdirectory("LocalePlugin")
add_subdirectory("NativeBoostPlugin")
add_subdirectory("UnixOSProcessPlugin")
add_dependencies(pharo SqueakFFIPrims)
add_subdirectory("SqueakFFIPrims")
add_dependencies(pharo JPEGReaderPlugin)
add_subdirectory("JPEGReaderPlugin")
add_dependencies(pharo JPEGReadWriter2Plugin)
add_subdirectory("JPEGReadWriter2Plugin")
add_dependencies(pharo RePlugin)
add_subdirectory("RePlugin")
add_dependencies(pharo InternetConfigPlugin)
add_subdirectory("InternetConfigPlugin")
add_dependencies(pharo SqueakSSL)
add_subdirectory("SqueakSSL")
target_link_libraries(pharo  ADPCMCodecPlugin AsynchFilePlugin B2DPlugin BitBltPlugin BMPReadWriterPlugin CroquetPlugin ZipPlugin DropPlugin DSAPrims FFTPlugin FileCopyPlugin FilePlugin FloatArrayPlugin FloatMathPlugin IA32ABI JoystickTabletPlugin Klatt LargeIntegers Matrix2x3Plugin MIDIPlugin MiscPrimitivePlugin Mpeg3Plugin SecurityPlugin SerialPlugin SocketPlugin SoundCodecPrims SoundPlugin StarSqueakPlugin SurfacePlugin LocalePlugin NativeBoostPlugin UnixOSProcessPlugin)
set_target_properties(pharo PROPERTIES LINK_FLAGS "-m32 -Wl,--export-dynamic")
set_source_files_properties( ${srcVMDir}/cogit.c PROPERTIES 
		COMPILE_FLAGS "-O1 -fno-omit-frame-pointer -momit-leaf-frame-pointer -mno-rtd -mno-accumulate-outgoing-args")
set_source_files_properties( ${targetPlatform}/vm/sqUnixHeartbeat.c PROPERTIES 
		COMPILE_FLAGS "-O1 -fno-omit-frame-pointer -mno-rtd -mno-accumulate-outgoing-args")
list(APPEND LINKLIBS m)
list(APPEND LINKLIBS pthread)
list(APPEND LINKLIBS execinfo)
set(EXECUTABLE_OUTPUT_PATH "${outputDir}")
add_subdirectory("vm-display-null")
add_subdirectory("vm-sound-null")
target_link_libraries(pharo ${LINKLIBS})
